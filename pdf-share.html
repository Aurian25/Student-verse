<!-- Minimal UI -->
<input type="file" id="fileInput" accept="application/pdf">
<button id="uploadBtn">Upload & Get Link</button>
<div id="status"></div>
<div id="result"></div>

<script>
const WORKER_URL = "https://pdf-proxy.suryasinghsn44.workers.dev/"; // <- REPLACE with your Worker URL

document.getElementById("uploadBtn").addEventListener("click", async () => {
  const f = document.getElementById("fileInput").files[0];
  if (!f) { alert("Select a PDF"); return; }

  const status = document.getElementById("status");
  const result = document.getElementById("result");
  status.textContent = "Uploading...";
  result.textContent = "";

  try {
    const res = await fetch(WORKER_URL, {
      method: "POST",
      headers: {
        "Content-Type": f.type || "application/pdf",
        "x-filename": f.name
      },
      body: f // send raw Blob as request body
    });

    const text = await res.text();

    if (!res.ok) throw new Error(text || `Status ${res.status}`);

    // transfer.sh returns a plain URL string (e.g. https://transfer.sh/abcd/filename.pdf)
    const link = text.trim();
    status.textContent = "Uploaded!";
    result.innerHTML = `
      <div>Share link (expires automatically):</div>
      <a href="${link}" target="_blank">${link}</a>
      <div style="margin-top:8px">
        <button id="copyBtn">Copy link</button>
      </div>
      <div style="margin-top:8px"><img src="https://chart.googleapis.com/chart?cht=qr&chs=240x240&chl=${encodeURIComponent(link)}" alt="QR"></div>
    `;
    document.getElementById("copyBtn").onclick = async () => {
      await navigator.clipboard.writeText(link);
      document.getElementById("copyBtn").textContent = "Copied!";
      setTimeout(()=>document.getElementById("copyBtn").textContent = "Copy link", 1500);
    };

  } catch (err) {
    status.textContent = "Error: " + (err.message || err);
  }
});
</script>
